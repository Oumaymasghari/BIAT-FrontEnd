{"ast":null,"code":"import { switchMap } from \"rxjs\";\nimport { PersonneServiceService } from \"src/app/shared/Services/PersonneService/personne-service.service\";\nimport { StorageService } from \"src/app/shared/Services/storage/storage.service\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared/Services/PersonneService/personne-service.service\";\nimport * as i2 from \"src/app/shared/Services/storage/storage.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction UserComponent_div_65_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 44)(2, \"h4\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"p\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"p\");\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    var ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r1.personne.nom, \" \", ctx_r1.personne.prenom, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Age: \", ctx_r1.personne.age, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"CIN: \", ctx_r1.personne.cin, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Date de naissance: \", ctx_r1.personne.dateNaissance, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"T\\u00E9l\\u00E9phone personnel: \", ctx_r1.personne.telPersonnel, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"T\\u00E9l\\u00E9phone Poste: \", ctx_r1.personne.telPoste, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Agence: \", ctx_r1.personne.agence, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Sexe: \", ctx_r1.personne.sexe, \"\");\n  }\n}\nfunction UserComponent_ng_container_77_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"img\", 45);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    var ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", \"data:image/jpeg;base64,\" + ctx_r2.personne.profilePicUrl.data, i0.ɵɵsanitizeUrl);\n  }\n}\nvar UserComponent = /** @class */function () {\n  function UserComponent(personneServiceService, storageService) {\n    this.personneServiceService = personneServiceService;\n    this.storageService = storageService;\n  }\n  UserComponent.prototype.ngOnInit = function () {\n    this.currentUser = this.storageService.getUser();\n    this.getpersonnebyid();\n    this.personne = {\n      id: null,\n      nom: null,\n      prenom: null,\n      profilePic: null,\n      age: null,\n      cin: null,\n      email: this.storageService.getUser().email,\n      dateNaissance: null,\n      sexe: null,\n      telPersonnel: null,\n      telPoste: null,\n      agence: null,\n      profilePicUrl: null,\n      userid: this.storageService.getUser().id\n    };\n    //  this.personneServiceService.getPersonneByUserId(this.storageService.getUser().id).subscribe(\n    //   (per) => {\n    //     console.log(\"per : \"+per);\n    //     return this.personneServiceService.getProfilePicUrl( per).subscribe(\n    //       (data) => {\n    //         console.log(data)\n    //         this.personne.profilePicUrl = data;\n    //       }\n    //     );\n    //    // return this.personneServiceService.uploadProfilePic(formData, per);\n    //   })\n  };\n\n  UserComponent.prototype.onFileSelected = function (event) {\n    this.selectedFile = event.target.files[0];\n  };\n  // uploadProfilePic(personneid:any): void {\n  //   console.log(\"test\");\n  //   if (this.selectedFile) {\n  //     this.personneServiceService.uploadProfilePic(this.selectedFile,personneid).subscribe((data) => {\n  //       console.log(data);\n  //       this.personne.profilePic = data.fileDownloadUri;\n  //     });\n  //   }\n  // }\n  UserComponent.prototype.onSubmit = function () {\n    var _this = this;\n    if (!this.selectedFile) {\n      console.log(\"No file selected.\");\n      return;\n    }\n    var formData = new FormData();\n    formData.append(\"file\", this.selectedFile);\n    this.personneServiceService.getPersonneByUserId(this.storageService.getUser().id).pipe(switchMap(function (per) {\n      _this.personneServiceService.getProfilePicUrl(per).subscribe(function (data) {\n        _this.personne.profilePicUrl = data;\n      });\n      return _this.personneServiceService.uploadProfilePic(formData, per);\n    })).subscribe(function (data) {\n      console.log(data);\n      // Read the uploaded file as a data URL\n      var reader = new FileReader();\n      reader.readAsDataURL(_this.selectedFile);\n      reader.onload = function () {\n        // Update the personne object with the new profile picture data URL\n        _this.personne.profilePicUrl = reader.result;\n      };\n      _this.personne.profilePicUrl = data.profilePicUrl;\n      // Update the personne object with the new profile picture URL\n      // this.personne.profilePic = data.fileDownloadUri;\n    }, function (error) {\n      console.log(error);\n    });\n  };\n  UserComponent.prototype.addPersonne = function (per) {\n    var _this = this;\n    // this.personneServiceService.addPersonne(per,this.storageService.getUser().id).subscribe();\n    var userId = this.storageService.getUser().id;\n    this.personneServiceService.getPERSONNEById(userId).subscribe(function (personne) {\n      if (personne) {\n        // If a personne already exists for this user, update their information\n        per.id = personne.id;\n        _this.getpersonnebyid();\n      } else {\n        // If no personne exists for this user, add a new one\n        _this.personneServiceService.addPersonne(per, userId).subscribe();\n        _this.personne = per; // Update the current personne to show their information\n      }\n    });\n  };\n\n  UserComponent.prototype.getAllpersonne = function () {\n    var _this = this;\n    this.personneServiceService.retrieveallPersonne().subscribe(function (res) {\n      _this.listPersonne = res;\n    });\n  };\n  UserComponent.prototype.getpersonnebyid = function () {\n    console.log(\"this.storageService.getUser().id\" + this.storageService.getUser().id);\n    this.personneServiceService.getPERSONNEById(this.storageService.getUser().id).subscribe();\n  };\n  UserComponent.ɵfac = function UserComponent_Factory(t) {\n    return new (t || UserComponent)(i0.ɵɵdirectiveInject(i1.PersonneServiceService), i0.ɵɵdirectiveInject(i2.StorageService));\n  };\n  UserComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UserComponent,\n    selectors: [[\"app-user\"]],\n    decls: 85,\n    vars: 12,\n    consts: [[1, \"content\"], [1, \"row\"], [1, \"col-md-8\"], [1, \"card\"], [1, \"card-header\"], [1, \"title\"], [1, \"card-body\"], [\"addForm\", \"\"], [1, \"col-md-3\", \"px-md-1\"], [1, \"form-group\"], [\"placeholder\", \"nom\", \"type\", \"text\", \"name\", \"nom\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"placeholder\", \"prenom\", \"type\", \"text\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-4\", \"pl-md-1\"], [\"placeholder\", \"votre age\", \"type\", \"number\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-4\", \"pl-md-1\", 2, \"width\", \"10px\"], [\"placeholder\", \"votre cin\", \"type\", \"number\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"placeholder\", \"date de naissance\", \"type\", \"date\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-6\", \"pr-md-1\"], [\"placeholder\", \"Telephone personnel\", \"type\", \"text\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-6\", \"pl-md-1\"], [\"placeholder\", \"Telephone Poste\", \"type\", \"text\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-4\", \"pr-md-1\"], [\"placeholder\", \"Votre Agence\", \"type\", \"text\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-4\", \"pr-md-1\", 2, \"width\", \"150px\", \"padding-left\", \"10px\", \"padding-right\", \"30px\"], [\"name\", \"dropdownOption\", \"id\", \"dropdownOption\", \"required\", \"\", \"name\", \"Sexe\", 1, \"form-control\", \"dropdown-danger\", \"dropdown-menu-right\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"homme\", 1, \"dropdown-item\"], [\"value\", \"femme\", 1, \"dropdown-item\"], [1, \"card-footer\"], [\"type\", \"submit\", 1, \"btn\", \"btn-fill\", \"btn-danger\", 2, \"background\", \"linear-gradient(rgb(250, 107, 25), rgb(233, 98, 30))\", 3, \"click\"], [\"class\", \"row\", 4, \"ngIf\", \"ngIfElse\"], [1, \"col-md-4\"], [1, \"card\", \"card-user\"], [1, \"card-text\"], [1, \"author\"], [1, \"block\", \"block-one\"], [1, \"block\", \"block-two\"], [1, \"block\", \"block-three\"], [1, \"block\", \"block-four\"], [\"href\", \"javascript:void(0)\"], [4, \"ngIf\"], [\"type\", \"file\", 2, \"display\", \"none\", 3, \"click\", \"change\"], [\"fileInput\", \"\"], [1, \"description\"], [1, \"card-description\"], [1, \"col-md-12\"], [1, \"avatar\", 3, \"src\"]],\n    template: function UserComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"h5\", 5);\n        i0.ɵɵtext(6, \"Edit Profile\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"div\", 6, 7)(9, \"form\")(10, \"div\", 1)(11, \"div\", 8)(12, \"div\", 9)(13, \"label\");\n        i0.ɵɵtext(14, \" nom \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"input\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_input_ngModelChange_15_listener($event) {\n          return ctx.personne.nom = $event;\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(16, \"div\", 8)(17, \"div\", 9)(18, \"label\");\n        i0.ɵɵtext(19, \" prenom \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"input\", 11);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_input_ngModelChange_20_listener($event) {\n          return ctx.personne.prenom = $event;\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(21, \"div\", 12)(22, \"div\", 9)(23, \"label\");\n        i0.ɵɵtext(24, \" age \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"input\", 13);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_input_ngModelChange_25_listener($event) {\n          return ctx.personne.age = $event;\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(26, \"div\", 14)(27, \"div\", 9)(28, \"label\");\n        i0.ɵɵtext(29, \" cin \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"input\", 15);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_input_ngModelChange_30_listener($event) {\n          return ctx.personne.cin = $event;\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(31, \"div\", 14)(32, \"div\", 9)(33, \"label\");\n        i0.ɵɵtext(34, \" date de naissance \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"input\", 16);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_input_ngModelChange_35_listener($event) {\n          return ctx.personne.dateNaissance = $event;\n        });\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(36, \"div\", 1)(37, \"div\", 17)(38, \"div\", 9)(39, \"label\");\n        i0.ɵɵtext(40, \" Telephone personnel \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"input\", 18);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_input_ngModelChange_41_listener($event) {\n          return ctx.personne.telPersonnel = $event;\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(42, \"div\", 19)(43, \"div\", 9)(44, \"label\");\n        i0.ɵɵtext(45, \" Telephone Poste \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(46, \"input\", 20);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_input_ngModelChange_46_listener($event) {\n          return ctx.personne.telPoste = $event;\n        });\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(47, \"div\", 1)(48, \"div\", 21)(49, \"div\", 9)(50, \"label\");\n        i0.ɵɵtext(51, \" Agence \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(52, \"input\", 22);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_input_ngModelChange_52_listener($event) {\n          return ctx.personne.agence = $event;\n        });\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(53, \"div\", 1)(54, \"div\", 23)(55, \"label\");\n        i0.ɵɵtext(56, \" Sexe \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(57, \"select\", 24);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_select_ngModelChange_57_listener($event) {\n          return ctx.personne.sexe = $event;\n        });\n        i0.ɵɵelementStart(58, \"option\", 25);\n        i0.ɵɵtext(59, \"homme\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(60, \"option\", 26);\n        i0.ɵɵtext(61, \"femme\");\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵelementStart(62, \"div\", 27)(63, \"button\", 28);\n        i0.ɵɵlistener(\"click\", function UserComponent_Template_button_click_63_listener() {\n          return ctx.addPersonne(ctx.personne);\n        });\n        i0.ɵɵtext(64, \"Save\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(65, UserComponent_div_65_Template, 18, 9, \"div\", 29);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(66, \"div\", 30)(67, \"div\", 31)(68, \"div\", 6);\n        i0.ɵɵelement(69, \"p\", 32);\n        i0.ɵɵelementStart(70, \"div\", 33);\n        i0.ɵɵelement(71, \"div\", 34)(72, \"div\", 35)(73, \"div\", 36)(74, \"div\", 37);\n        i0.ɵɵelementStart(75, \"a\", 38)(76, \"div\");\n        i0.ɵɵtemplate(77, UserComponent_ng_container_77_Template, 2, 1, \"ng-container\", 39);\n        i0.ɵɵelementStart(78, \"input\", 40, 41);\n        i0.ɵɵlistener(\"click\", function UserComponent_Template_input_click_78_listener() {\n          return ctx.onSubmit();\n        })(\"change\", function UserComponent_Template_input_change_78_listener($event) {\n          return ctx.onFileSelected($event);\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(80, \"h5\", 5);\n        i0.ɵɵtext(81, \"Oumayma sghari\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(82, \"p\", 42);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(83, \"div\", 43);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(84, \"div\", 27);\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        var _r0 = i0.ɵɵreference(8);\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"ngModel\", ctx.personne.nom);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.personne.prenom);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.personne.age);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.personne.cin);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.personne.dateNaissance);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.personne.telPersonnel);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.personne.telPoste);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.personne.agence);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.personne.sexe);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngIf\", ctx.personne)(\"ngIfElse\", _r0);\n        i0.ɵɵadvance(12);\n        i0.ɵɵproperty(\"ngIf\", ctx.personne.profilePicUrl);\n      }\n    },\n    dependencies: [i3.NgIf, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm],\n    styles: [\".form-control[_ngcontent-%COMP%]:focus {\\n  border-color: #db5a1f;\\n}\"]\n  });\n  return UserComponent;\n}();\nexport { UserComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}