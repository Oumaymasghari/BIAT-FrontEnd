{"ast":null,"code":"import { switchMap } from \"rxjs\";\nimport { PersonneServiceService } from \"src/app/shared/Services/PersonneService/personne-service.service\";\nimport { StorageService } from \"src/app/shared/Services/storage/storage.service\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared/Services/PersonneService/personne-service.service\";\nimport * as i2 from \"src/app/shared/Services/storage/storage.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction UserComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"form\", 25);\n    i0.ɵɵlistener(\"ngSubmit\", function UserComponent_div_7_Template_form_ngSubmit_1_listener() {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.submitForm());\n    });\n    i0.ɵɵelementStart(2, \"div\", 1)(3, \"div\", 26)(4, \"div\", 27)(5, \"label\");\n    i0.ɵɵtext(6, \" nom \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"input\", 28);\n    i0.ɵɵlistener(\"ngModelChange\", function UserComponent_div_7_Template_input_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.personne.nom = $event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(8, \"div\", 26)(9, \"div\", 27)(10, \"label\");\n    i0.ɵɵtext(11, \" prenom \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"input\", 29);\n    i0.ɵɵlistener(\"ngModelChange\", function UserComponent_div_7_Template_input_ngModelChange_12_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.personne.prenom = $event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(13, \"div\", 30)(14, \"div\", 27)(15, \"label\");\n    i0.ɵɵtext(16, \" age \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"input\", 31);\n    i0.ɵɵlistener(\"ngModelChange\", function UserComponent_div_7_Template_input_ngModelChange_17_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.personne.age = $event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(18, \"div\", 32)(19, \"div\", 27)(20, \"label\");\n    i0.ɵɵtext(21, \" cin \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"input\", 33);\n    i0.ɵɵlistener(\"ngModelChange\", function UserComponent_div_7_Template_input_ngModelChange_22_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.personne.cin = $event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(23, \"div\", 32)(24, \"div\", 27)(25, \"label\");\n    i0.ɵɵtext(26, \" date de naissance \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"input\", 34);\n    i0.ɵɵlistener(\"ngModelChange\", function UserComponent_div_7_Template_input_ngModelChange_27_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.personne.dateNaissance = $event);\n    });\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(28, \"div\", 1)(29, \"div\", 35)(30, \"div\", 27)(31, \"label\");\n    i0.ɵɵtext(32, \" Telephone personnel \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(33, \"input\", 36);\n    i0.ɵɵlistener(\"ngModelChange\", function UserComponent_div_7_Template_input_ngModelChange_33_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.personne.telPersonnel = $event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(34, \"div\", 37)(35, \"div\", 27)(36, \"label\");\n    i0.ɵɵtext(37, \" Telephone Poste \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(38, \"input\", 38);\n    i0.ɵɵlistener(\"ngModelChange\", function UserComponent_div_7_Template_input_ngModelChange_38_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.personne.telPoste = $event);\n    });\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(39, \"div\", 1)(40, \"div\", 39)(41, \"div\", 27)(42, \"label\");\n    i0.ɵɵtext(43, \" Agence \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(44, \"input\", 40);\n    i0.ɵɵlistener(\"ngModelChange\", function UserComponent_div_7_Template_input_ngModelChange_44_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.personne.agence = $event);\n    });\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(45, \"div\", 1)(46, \"div\", 41)(47, \"label\");\n    i0.ɵɵtext(48, \" Sexe \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(49, \"select\", 42);\n    i0.ɵɵlistener(\"ngModelChange\", function UserComponent_div_7_Template_select_ngModelChange_49_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.personne.sexe = $event);\n    });\n    i0.ɵɵelementStart(50, \"option\", 43);\n    i0.ɵɵtext(51, \"homme\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(52, \"option\", 44);\n    i0.ɵɵtext(53, \"femme\");\n    i0.ɵɵelementEnd()()()()()();\n  }\n  if (rf & 2) {\n    var ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.personne.nom);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.personne.prenom);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.personne.age);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.personne.cin);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.personne.dateNaissance);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.personne.telPersonnel);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.personne.telPoste);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.personne.agence);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.personne.sexe);\n  }\n}\nfunction UserComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 45)(2, \"h4\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"p\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"p\");\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    var ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r1.personne.nom, \" \", ctx_r1.personne.prenom, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Age: \", ctx_r1.personne.age, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"CIN: \", ctx_r1.personne.cin, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Date de naissance: \", ctx_r1.personne.dateNaissance, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"T\\u00E9l\\u00E9phone personnel: \", ctx_r1.personne.telPersonnel, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"T\\u00E9l\\u00E9phone Poste: \", ctx_r1.personne.telPoste, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Agence: \", ctx_r1.personne.agence, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Sexe: \", ctx_r1.personne.sexe, \"\");\n  }\n}\nfunction UserComponent_ng_container_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"img\", 46);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    var ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", \"data:image/jpeg;base64,\" + ctx_r2.personne.profilePicUrl.data, i0.ɵɵsanitizeUrl);\n  }\n}\nvar UserComponent = /** @class */function () {\n  function UserComponent(personneServiceService, storageService) {\n    this.personneServiceService = personneServiceService;\n    this.storageService = storageService;\n    this.person = false;\n  }\n  UserComponent.prototype.ngOnInit = function () {\n    this.currentUser = this.storageService.getUser();\n    this.getpersonnebyid();\n    this.personne = {\n      id: null,\n      nom: null,\n      prenom: null,\n      profilePic: null,\n      age: null,\n      cin: null,\n      email: this.storageService.getUser().email,\n      dateNaissance: null,\n      sexe: null,\n      telPersonnel: null,\n      telPoste: null,\n      agence: null,\n      profilePicUrl: null,\n      userid: this.storageService.getUser().id\n    };\n    //  this.personneServiceService.getPersonneByUserId(this.storageService.getUser().id).subscribe(\n    //   (per) => {\n    //     console.log(\"per : \"+per);\n    //     return this.personneServiceService.getProfilePicUrl( per).subscribe(\n    //       (data) => {\n    //         console.log(data)\n    //         this.personne.profilePicUrl = data;\n    //       }\n    //     );\n    //    // return this.personneServiceService.uploadProfilePic(formData, per);\n    //   })\n  };\n\n  UserComponent.prototype.onFileSelected = function (event) {\n    this.selectedFile = event.target.files[0];\n  };\n  // uploadProfilePic(personneid:any): void {\n  //   console.log(\"test\");\n  //   if (this.selectedFile) {\n  //     this.personneServiceService.uploadProfilePic(this.selectedFile,personneid).subscribe((data) => {\n  //       console.log(data);\n  //       this.personne.profilePic = data.fileDownloadUri;\n  //     });\n  //   }\n  // }\n  UserComponent.prototype.onSubmit = function () {\n    var _this = this;\n    if (!this.selectedFile) {\n      console.log(\"No file selected.\");\n      return;\n    }\n    var formData = new FormData();\n    formData.append(\"file\", this.selectedFile);\n    this.personneServiceService.getPersonneByUserId(this.storageService.getUser().id).pipe(switchMap(function (per) {\n      _this.personneServiceService.getProfilePicUrl(per).subscribe(function (data) {\n        _this.personne.profilePicUrl = data;\n      });\n      return _this.personneServiceService.uploadProfilePic(formData, per);\n    })).subscribe(function (data) {\n      console.log(data);\n      // Read the uploaded file as a data URL\n      var reader = new FileReader();\n      reader.readAsDataURL(_this.selectedFile);\n      reader.onload = function () {\n        // Update the personne object with the new profile picture data URL\n        _this.personne.profilePicUrl = reader.result;\n      };\n      _this.personne.profilePicUrl = data.profilePicUrl;\n      // Update the personne object with the new profile picture URL\n      // this.personne.profilePic = data.fileDownloadUri;\n    }, function (error) {\n      console.log(error);\n    });\n  };\n  UserComponent.prototype.addPersonne = function (per) {\n    var _this = this;\n    // this.personneServiceService.addPersonne(per,this.storageService.getUser().id).subscribe();\n    var userId = this.storageService.getUser().id;\n    this.personneServiceService.getPERSONNEById(userId).subscribe(function (personne) {\n      if (personne) {\n        // If a personne already exists for this user, update their information\n        per.id = personne.id;\n        _this.getpersonnebyid();\n      } else {\n        // If no personne exists for this user, add a new one\n        _this.personneServiceService.addPersonne(per, userId).subscribe();\n        _this.personne = per; // Update the current personne to show their information\n      }\n    });\n  };\n\n  UserComponent.prototype.getAllpersonne = function () {\n    var _this = this;\n    this.personneServiceService.retrieveallPersonne().subscribe(function (res) {\n      _this.listPersonne = res;\n    });\n  };\n  UserComponent.prototype.getpersonnebyid = function () {\n    console.log(\"this.storageService.getUser().id\" + this.storageService.getUser().id);\n    this.personneServiceService.getPERSONNEById(this.storageService.getUser().id).subscribe();\n  };\n  UserComponent.prototype.submitForm = function () {\n    var _this = this;\n    this.personneServiceService.getPERSONNEById(this.storageService.getUser().id).subscribe(function (personne) {\n      if (personne != null) {\n        // If userid exists, show the person information\n        _this.person = true;\n        _this.getpersonnebyid();\n      } else {}\n    }, function (error) {\n      // If userid does not exist, show the form again\n      _this.person = false;\n    });\n  };\n  UserComponent.ɵfac = function UserComponent_Factory(t) {\n    return new (t || UserComponent)(i0.ɵɵdirectiveInject(i1.PersonneServiceService), i0.ɵɵdirectiveInject(i2.StorageService));\n  };\n  UserComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UserComponent,\n    selectors: [[\"app-user\"]],\n    decls: 31,\n    vars: 3,\n    consts: [[1, \"content\"], [1, \"row\"], [1, \"col-md-8\"], [1, \"card\"], [1, \"card-header\"], [1, \"title\"], [\"class\", \" card-body\", 4, \"ngIf\"], [1, \"card-footer\"], [\"type\", \"submit\", 1, \"btn\", \"btn-fill\", \"btn-danger\", 2, \"background\", \"linear-gradient(rgb(250, 107, 25), rgb(233, 98, 30))\", 3, \"click\"], [\"class\", \"row\", 4, \"ngIf\"], [1, \"col-md-4\"], [1, \"card\", \"card-user\"], [1, \"card-body\"], [1, \"card-text\"], [1, \"author\"], [1, \"block\", \"block-one\"], [1, \"block\", \"block-two\"], [1, \"block\", \"block-three\"], [1, \"block\", \"block-four\"], [\"href\", \"javascript:void(0)\"], [4, \"ngIf\"], [\"type\", \"file\", 2, \"display\", \"none\", 3, \"click\", \"change\"], [\"fileInput\", \"\"], [1, \"description\"], [1, \"card-description\"], [3, \"ngSubmit\"], [1, \"col-md-3\", \"px-md-1\"], [1, \"form-group\"], [\"placeholder\", \"nom\", \"type\", \"text\", \"name\", \"nom\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"placeholder\", \"prenom\", \"type\", \"text\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-4\", \"pl-md-1\"], [\"placeholder\", \"votre age\", \"type\", \"number\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-4\", \"pl-md-1\", 2, \"width\", \"10px\"], [\"placeholder\", \"votre cin\", \"type\", \"number\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"placeholder\", \"date de naissance\", \"type\", \"date\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-6\", \"pr-md-1\"], [\"placeholder\", \"Telephone personnel\", \"type\", \"text\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-6\", \"pl-md-1\"], [\"placeholder\", \"Telephone Poste\", \"type\", \"text\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-4\", \"pr-md-1\"], [\"placeholder\", \"Votre Agence\", \"type\", \"text\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-4\", \"pr-md-1\", 2, \"width\", \"150px\", \"padding-left\", \"10px\", \"padding-right\", \"30px\"], [\"name\", \"dropdownOption\", \"id\", \"dropdownOption\", \"required\", \"\", \"name\", \"Sexe\", 1, \"form-control\", \"dropdown-danger\", \"dropdown-menu-right\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"homme\", 1, \"dropdown-item\"], [\"value\", \"femme\", 1, \"dropdown-item\"], [1, \"col-md-12\"], [1, \"avatar\", 3, \"src\"]],\n    template: function UserComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"h5\", 5);\n        i0.ɵɵtext(6, \"Edit Profile\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(7, UserComponent_div_7_Template, 54, 9, \"div\", 6);\n        i0.ɵɵelementStart(8, \"div\", 7)(9, \"button\", 8);\n        i0.ɵɵlistener(\"click\", function UserComponent_Template_button_click_9_listener() {\n          return ctx.addPersonne(ctx.personne);\n        });\n        i0.ɵɵtext(10, \"Save\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(11, UserComponent_div_11_Template, 18, 9, \"div\", 9);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"div\", 10)(13, \"div\", 11)(14, \"div\", 12);\n        i0.ɵɵelement(15, \"p\", 13);\n        i0.ɵɵelementStart(16, \"div\", 14);\n        i0.ɵɵelement(17, \"div\", 15)(18, \"div\", 16)(19, \"div\", 17)(20, \"div\", 18);\n        i0.ɵɵelementStart(21, \"a\", 19)(22, \"div\");\n        i0.ɵɵtemplate(23, UserComponent_ng_container_23_Template, 2, 1, \"ng-container\", 20);\n        i0.ɵɵelementStart(24, \"input\", 21, 22);\n        i0.ɵɵlistener(\"click\", function UserComponent_Template_input_click_24_listener() {\n          return ctx.onSubmit();\n        })(\"change\", function UserComponent_Template_input_change_24_listener($event) {\n          return ctx.onFileSelected($event);\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(26, \"h5\", 5);\n        i0.ɵɵtext(27, \"Oumayma sghari\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(28, \"p\", 23);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(29, \"div\", 24);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(30, \"div\", 7);\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngIf\", !ctx.person);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.person);\n        i0.ɵɵadvance(12);\n        i0.ɵɵproperty(\"ngIf\", ctx.personne.profilePicUrl);\n      }\n    },\n    dependencies: [i3.NgIf, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm],\n    styles: [\".form-control[_ngcontent-%COMP%]:focus {\\n  border-color: #db5a1f;\\n}\"]\n  });\n  return UserComponent;\n}();\nexport { UserComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}