{"ast":null,"code":"import { __decorate, __metadata } from \"tslib\";\nimport { Component } from \"@angular/core\";\nimport { switchMap } from \"rxjs\";\nimport { PersonneServiceService } from \"src/app/shared/Services/PersonneService/personne-service.service\";\nimport { StorageService } from \"src/app/shared/Services/storage/storage.service\";\nvar UserComponent = /** @class */function () {\n  function UserComponent(personneServiceService, storageService) {\n    this.personneServiceService = personneServiceService;\n    this.storageService = storageService;\n  }\n  UserComponent.prototype.ngOnInit = function () {\n    this.currentUser = this.storageService.getUser();\n    this.personne = {\n      id: null,\n      nom: null,\n      prenom: null,\n      profilePic: null,\n      age: null,\n      cin: null,\n      email: this.storageService.getUser().email,\n      dateNaissance: null,\n      sexe: null,\n      telPersonnel: null,\n      telPoste: null,\n      agence: null,\n      profilePicUrl: null,\n      userid: this.storageService.getUser().id\n    };\n  };\n  UserComponent.prototype.onFileSelected = function (event) {\n    this.selectedFile = event.target.files[0];\n  };\n  // uploadProfilePic(personneid:any): void {\n  //   console.log(\"test\");\n  //   if (this.selectedFile) {\n  //     this.personneServiceService.uploadProfilePic(this.selectedFile,personneid).subscribe((data) => {\n  //       console.log(data);\n  //       this.personne.profilePic = data.fileDownloadUri;\n  //     });\n  //   }\n  // }\n  UserComponent.prototype.onSubmit = function () {\n    var _this = this;\n    if (!this.selectedFile) {\n      console.log(\"No file selected.\");\n      return;\n    }\n    var formData = new FormData();\n    formData.append(\"file\", this.selectedFile);\n    this.personneServiceService.getPersonneByUserId(this.storageService.getUser().id).pipe(switchMap(function (per) {\n      _this.personneServiceService.getProfilePicUrl(per).subscribe(function (data) {\n        _this.personne.profilePicUrl = data;\n      });\n      return _this.personneServiceService.uploadProfilePic(formData, per);\n    })).subscribe(function (data) {\n      console.log(data);\n      // Read the uploaded file as a data URL\n      var reader = new FileReader();\n      reader.readAsDataURL(_this.selectedFile);\n      reader.onload = function () {\n        // Update the personne object with the new profile picture data URL\n        _this.personne.profilePicUrl = reader.result;\n      };\n      _this.personne.profilePicUrl = data.profilePicUrl;\n      // Update the personne object with the new profile picture URL\n      // this.personne.profilePic = data.fileDownloadUri;\n    }, function (error) {\n      console.log(error);\n    });\n  };\n  UserComponent.prototype.addPersonne = function (per) {\n    this.personneServiceService.addPersonne(per, this.storageService.getUser().id).subscribe();\n  };\n  UserComponent.prototype.getAllcov = function () {\n    var _this = this;\n    this.personneServiceService.retrieveallPersonne().subscribe(function (res) {\n      _this.listPersonne = res;\n    });\n  };\n  UserComponent = __decorate([Component({\n    selector: \"app-user\",\n    templateUrl: \"user.component.html\",\n    styleUrls: ['./user.component.scss']\n  }), __metadata(\"design:paramtypes\", [PersonneServiceService, StorageService])], UserComponent);\n  return UserComponent;\n}();\nexport { UserComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}